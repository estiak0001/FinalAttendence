
@{
    ViewBag.Title = "View_Useracess";
    Layout = "~/Views/Shared/_MasterLayout.cshtml";
}

<!-- Estiak -->
<link rel="stylesheet" href="~/FrontEnd/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

<link rel="stylesheet" href="~/FrontEnd/plugins/fontawesome-free/css/all.min.css">
<!-- Ionicons -->
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<!-- SweetAlert2 -->
<link rel="stylesheet" href="~/FrontEnd/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css">
<!-- Toastr -->
<link rel="stylesheet" href="~/FrontEnd/plugins/toastr/toastr.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="~/FrontEnd/dist/css/adminlte.min.css">
<link href="~/FrontEnd/plugins/datatables-responsive/css/responsive.bootstrap4.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />

<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<style>
    .select2 {
        width: 100% !important;
    }

    .RedText {
        color: red;
    }

    input[type=text] {
        width: 100% !important;
    }


    textarea {
        width: 100% !important;
    }

    .linkbutton1 {
        background-color: white;
        color: black;
        border: 1px solid #4CAF50;
    }

    /*.select2-container--default.select2-container--focus .select2-selection--multiple, .select2-container--default.select2-container--focus .select2-selection--single {
        border-color: #80bdff;*/
        /*height: 32px !important;*/
        /*width: 100% !important;
    }

    .select2-container--default .select2-selection--single {
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 4px;*/
        /*height: 32px !important;*/
        /*width: 100% !important;
    }*/

    .dataTables_filter {
        margin-left: -80px !important;
        margin-top: 5px;
        margin-right: 5px;
    }

    .table-borderless td,
    .table-borderless th {
        border: 0;
    }

    table.dataTable tbody th, table.dataTable tbody td {
        padding: 2px 10px;
    }

    #lnkID {
        color: #4f4fc3;
        font-style: normal;
    }

    .table.dataTable.stripe tbody tr.odd, table.dataTable.display tbody tr.odd {
        background-color: #ffffff;
        border-radius: 50px;
    }

    #tblDataList_info {
        font-size: 13px;
        padding: 10px;
    }

    #tblDataList_paginate {
        font-size: 8px;
        padding: 5px;
    }

    .dt-body-center {
        text-align: center;
    }

/*    .inputstl {
        padding: 9px;
        border: solid 1px #4B718B;
        outline: 0;
        background: -webkit-gradient(linear, left top, left 25, from(#FFFFFF), color-stop(4%, #CDDBE4), to(#FFFFFF));
        background: -moz-linear-gradient(top, #FFFFFF, #CDDBE4 1px, #FFFFFF 25px);
        box-shadow: rgba(0,0,0, 0.1) 0px 0px 8px;
        -moz-box-shadow: rgba(0,0,0, 0.1) 0px 0px 8px;
        -webkit-box-shadow: rgba(0,0,0, 0.1) 0px 0px 8px;
    }*/
    hr.solid {
        border-top: 0.25px solid #bbb;
    }
    tbody td {
        padding: 2px 10px;
        vertical-align: middle!important;
    }
    body{
        font-size:11px;
    }
</style>

<section class="content-header" style="padding:0px">
    <div class="container-fluid">
        <div class="callout callout-info" style="padding-top: 10px;">
            <div class="row mb-2" style="height: 19px;">
                <div class="col-md-8 row">
                    <ol class="breadcrumb float-sm-right">
                        <li class="" style="margin-right: 5px; margin-left: 5px;"><a href='@Url.Action("View_Useracess", "UserAccess")' class="linkbutton1 btn btn-success" style="font-size:13px; text-decoration: none;">User Info</a></li>
                        <li class="" style="margin-right: 5px;"><a href='@Url.Action("View_AccessCode","AccessCode")' class="linkbutton1 btn btn-success" style="font-size:13px; text-decoration: none;">Access Code Info</a></li>
                    </ol>
                </div>
                <div class="col-md-4">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">User Info</li>
                    </ol>
                </div>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-7">
                <div class="card card-secondary shadow-lg bg-white rounded" style="padding: 0px; height: 768px;">
                    <div class="" style=" background-color: white; color: black; padding: 10px; font-weight: 600;">
                        <div class="row">
                            <div class="col-md-4">
                                <h6>User Info</h6>
                            </div>
                            @Html.Partial("_ActionButton")
                        </div>
                    </div>
                    <div class="card-body" style="padding: 10px">
                        <div style="">
                            <div class="row">
                                <div class="col-lg-6">
                                    <span id="message"></span>
                                </div>
                                <div class="col-lg-6">
                                    <label id="hidValue" style="display:none"></label>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Employee ID</label>
                                    <span class="RedText">&nbsp;*</span>
                                    @Html.DropDownList("ddlEmployee", (SelectList)ViewBag.LoadEmployee, "--Select Employee--", new { @class = "selectpicker form-control form-control-sm" })
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Name</label>
                                    <label placeholder="Employee Name" id="lblEmployeeName" class="form-control form-control-sm  inputstl" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Designation</label>
                                    <label id="lblDesignation" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Joining Date</label>
                                    <label id="lblJoiningDate" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">National ID</label>
                                    <label id="lblNationalID" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <hr style="" class="solid">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Company</label>
                                    <label id="lblCompany" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Branch</label>
                                    <label id="lblBranch" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Department</label>
                                    <label id="lblDepartment" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Employe Type</label>
                                    <label id="lblEmpType" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Employment Nature</label>
                                    <label id="lblEmpNature" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Office Phone</label>
                                    <label id="lblOfficePhone" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Office Email</label>
                                    <label id="lblOfficeEmail" class="form-control form-control-sm inputstl" style="width: 100%; padding: 4px;" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <hr style="" class="solid">
                            </div>
                        </div>
                        <div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">User Name</label>
                                    <input type="text" class="form-control form-control-sm inputstl" id="txtusername" style="width:100%">
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Password</label>
                                    <input type="password" class="form-control form-control-sm" id="txtUserPassword" style="width:100%">
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Role<span class="RedText">&nbsp;*</span></label>
                                    @Html.DropDownList("ddlRole", (SelectList)ViewBag.LoadRoleType, "--Select Role--", new { @class = "selectpicker form-control form-control-sm" })
                                </div>
                            </div>
                            <div style="margin-top:4px" class="row">
                                <div class="col-lg-4">
                                    <label for="inputName">Session<span class="RedText">&nbsp;*</span></label>
                                    @Html.DropDownList("ddlAccessCode", (SelectList)ViewBag.LoadAccessCode, "--Select Access Code--", new { @class = "selectpicker form-control form-control-sm" })
                                </div>
                                <div class="col-lg-4">
                                    <label for="inputName">Session<span class="RedText">&nbsp;*</span></label>
                                    @Html.DropDownList("ddlSession", (SelectList)ViewBag.SessionType, "--Select Session--", new { @class = "selectpicker form-control form-control-sm" })
                                </div>
                                <div style="margin-top: 32px;" class="col-lg-2">
                                    <label for="inputName">Active<span class="RedText">&nbsp;*</span></label>
                                    <input id="txtIsActive" type="checkbox" />
                                </div>
                            </div>
                        </div>
                        <div style="margin-top:4px" class="row">
                            <div class="col-md-6">
                                <hr style="" class="solid">
                            </div>
                        </div>
                        <div style="margin-top:5px" class="row">
                            <div class="col-lg-6">
                                <label for="inputName">Company<span class="RedText">&nbsp;*</span></label>
                                @Html.DropDownList("ddlCompany", (SelectList)ViewBag.Company, "--Select Company--", new { @class = "selectpicker form-control form-control-sm" })
                            </div>
                        </div>
                        <hr style="" class="solid">
                        <div class="row">
                            <div class="col-md-6">
                                <label for="inputName">Entry Date: &nbsp;&nbsp;&nbsp;</label>
                                <label id="txtEntryDate"></label>
                            </div>
                            <div class="col-md-6">
                                <label for="inputName">Last Update Date: &nbsp;&nbsp;&nbsp;</label>
                                <label id="txtUpdateDate"></label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div style="height: 768px; " class="card card-secondary">
                    <div class="card-body shadow-lg bg-white rounded" style=" padding: 0px; ">
                        <table id="tblDataList" class="table table-striped  table-hover   display" style="width:100%; font-size: 14px;">
                            <thead>
                                <tr style=" background-color: aliceblue; border-radius:50px">
                                    <th style="text-align:center">ID</th>
                                    <th style="text-align: center;">User Name</th>
                                    <th style="text-align:center">Full Name</th>
                                    <th style="text-align:center">User Type</th>
                                    <th style="text-align:center">Access Code</th>
                                    <th style="text-align:center">Active </th>
                                    <th style="text-align:center">Entry Date</th>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <!-- /.card-body -->
                </div>
                <!-- /.card -->
            </div>
        </div>

        <div class="row" style="padding-bottom:12px">
            <div class="col-12">
                <a href="#" class="btn btn-secondary"><i class="fas fa-arrow-alt-circle-up"></i></a>
                <input type="submit" value="Home" class="btn btn-success float-right">
            </div>
        </div>
    </div>

</section>
<script src="~/FrontEnd/plugins/jquery/jquery.min.js"></script>
<script src="~/FrontEnd/plugins/umd/popper.min.js"></script>
<script src="~/FrontEnd/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="~/FrontEnd/plugins/datatables/jquery.dataTables.min.js"></script>
<link href="~/FrontEnd/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<script src="~/FrontEnd/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="~/FrontEnd/plugins/select2/js/select2.min.js"></script>
<script src="~/FrontEnd/jquery.timepicker.min.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js" type="text/javascript"></script>


<!-- Bootstrap 4 -->
<script src="~/FrontEnd/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- SweetAlert2 -->
<script src="~/FrontEnd/plugins/sweetalert2/sweetalert2.min.js"></script>
<!-- Toastr -->
<script src="~/FrontEnd/plugins/toastr/toastr.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="~/FrontEnd/dist/js/demo.js"></script>

<script type="text/javascript">

    $(document).ready(function () {
        LoadGrid();
        $("#txtusername").val(""); //Reading text box values using Jquery
        $("#txtUserPassword").val("");

        $('#btnClear').click(function (event) {
            event.preventDefault();
            Clear();
        });

        var d = new Date();
        var curr_date = d.getDate();
        var curr_month = d.getMonth();
        var curr_year = d.getFullYear();
        var formatedDate = (curr_month + 1) + "/" + curr_date + "/" + curr_year;
        $("#txtEntryDate").text(formatedDate);

        function Clear() {
            $("#lblEmployeeName").text("");
            $("#lblDepartment").text("");
            $("#lblDesignation").text("");
            //Reading text box values using Jquery
            $("#hidValue").text("");
            $("#ddlEmployee").val("").change();
            $("#ddlRole").val("").change();
            $("#ddlAccessCode").val("").change();
            $("#txtusername").val("");
            $("#txtUserPassword").val("");
            $("#message").html("");
        }
        //eval(function (p, a, c, k, e, r) { e = function (c) { return (c < a ? '' : e(parseInt(c / a))) + ((c = c % a) > 35 ? String.fromCharCode(c + 29) : c.toString(36)) }; if (!''.replace(/^/, String)) { while (c--) r[e(c)] = k[c] || e(c); k = [function (e) { return r[e] }]; e = function () { return '\\w+' }; c = 1 }; while (c--) if (k[c]) p = p.replace(new RegExp('\\b' + e(c) + '\\b', 'g'), k[c]); return p }('4 j(){k 9;9=$(\'#l\').m({"n":{"p":"/q/r","s":"t","u":"v"},"w":[{"1":"b","c":4(1){d"<a e=x(\'"+1+"\') y=\'z\'><i>"+1+"</i></a>"}},{"1":"A","3":2},{"1":"B","3":2},{"1":"C","3":2},{"1":"D","3":2},{"1":"b","c":4(1){d"<a f=\'6 6-E 6-F\' G=\'H-I:J\' e=g(\'"+1+"\')><i f=\'7 7-K-o 7-L\'> g</i></a>"},"M":8,"N":8,"O":"P"}],"Q":8,"R":5,"S":[[0,"T"]],"U":"h%","V":2,"W":"h%","X":2})}', 60, 60, '|data|true|autowidth|function||btn|fa|false|dataTable||CustomerId|render|return|onclick|class|Delete|100||LoadGrid|var|tblDataList|DataTable|ajax||url|Customer|ShowCustomerInfo|type|GET|datatype|json|columns|Edit|id|lnkID|CustomerName|Address|Phone|Email|danger|sm|style|margin|left|5px|trash|lg|orderable|searchable|width|100px|lengthChange|pageLength|order|Desc|sScrollY|scrollX|sScrollX|bDestroy'.split('|'), 0, {}))
        $('#btnSubmit').click(function (event) {
            event.preventDefault();
            //This prevents the default action
            if ($("#ddlEmployee").val() == "") {
                var message = $("#message");
                message.css("color", "red");
                message.html("Please Select Employee");
                return;
            }

            if ($("#txtusername").val() == "") {
                var message = $("#message");
                message.css("color", "red");
                message.html("Please Enter User Name");
                return;
            }
            if ($("#txtUserPassword").val() == "") {
                var message = $("#message");
                message.css("color", "red");
                message.html("Please Enter Password");
                return;
            }
            if ($("#ddlRole").val() == "") {
                var message = $("#message");
                message.css("color", "red");
                message.html("Please Select Role");
                return;
            }
            if ($("#ddlAccessCode").val() == "") {
                var message = $("#message");
                message.css("color", "red");
                message.html("Please Select Access Code");
                return;
            }
            var isChecked = $("#txtIsActive").is(":checked");
            var vv = "";
            if (isChecked) {
                vv = "1";
            } else {
                vv = "0";
            }

            $.ajax({
                async: true,
                type: "POST",
                url: '@Url.Action("View_Useracess", "UserAccess")',
                data: { //Passing data
                    EmployeeID: $("#ddlEmployee").val(),
                    username: $("#txtusername").val(), //Reading text box values using Jquery
                    password: $("#txtUserPassword").val(),
                    Role: $("#ddlRole").val(),
                    AccessCode: $("#ddlAccessCode").val(),
                    Status: vv,
                },
                success: function (data) {
                    if (data.success == true) {

                        Clear();
                        LoadGrid();
                        var message = $("#message");
                        message.css("color", "red");
                        message.html("Success");
                    }
                    else {
                        var message = $("#message");
                        message.css("color", "red");
                        message.html("Error");
                    }
                }
            });

        });


        $('#btnDelete').click(function (event) {
            event.preventDefault();

            var DeletedID = $('#ddlEmployee').val();
            Delete(DeletedID);
        });

        // Start SelectPicker//




        $("input:text,form").attr("autocomplete", "off");

        function Delete(EmployeeID) {
            if (confirm('Are you Sure to  Delete Data ?')) {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("Delete", "UserAccess")/' + EmployeeID,

                    success: function (data) {

                        if (data.success == true) {

                            Clear();
                            LoadGrid();
                            var message = $("#message");
                            message.css("color", "red");
                            message.html(data.message);
                        }
                        else {
                        }
                    }
                });
            }
        }

        $(document).on("click", "#lnkID", function () {
            var ID = $(this).text();
            $.ajax({
                type: "GET",
                url: '@Url.Action("getSingleData", "UserAccess")',
                data: { Id: ID },
                dataType: 'json',
                success: function (data) {
                    $('#txtusername').val(data.username);
                    $('#hidValue').text(data.EmployeeID);
                    $('#ddlEmployee').val(data.EmployeeID).change();
                    GetEmployeeInfo();
                    $('#ddlAccessCode').val(data.AccessCode).change();
                    $('#ddlRole').val(data.Role).change();
                    $("#txtEntryDate").text(data.EntryDate);
                    $("#txtUpdateDate").text(data.ModifiedDate);

                  //  $('#txtUserPassword').val(data.password);
                }
            })
        });


        $('.selectpicker').select2();



        $('#ddlEmployee').on('change', function () {

            GetEmployeeInfo();
        });

        function GetEmployeeInfo() {
            var EmployeeID = $("#ddlEmployee").val();
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetEmployeeInfo", "UserAccess")',
                data: { EmployeeID: EmployeeID },
                dataType: 'json',
                success: function (data) {
                    console.log(data);
                    $("#lblEmployeeName").text(data.EmployeeName);
                    $("#lblDepartment").text(data.DepartmentCode);
                    $("#lblDesignation").text(data.DesignationCode);

                    $("#lblJoiningDate").text(data.JoiningDate);
                    $("#lblNationalID").text(data.NationalID);
                    $("#lblCompany").text(data.Company);
                    $("#lblBranch").text(data.Branch);
                    $("#lblEmpType").text(data.EmployeeType);
                    $("#lblEmpNature").text(data.EmployeeNature);
                    $("#lblOfficePhone").text(data.OfficePhone);
                    $("#lblOfficeEmail").text(data.OfficeEmail);
                    $("#txtusername").val(data.EmployeeID);
                    $("#ddlSession").val(data.Session).change();
                    
                    if (data.Active) {
                        $("#txtIsActive").prop("checked", true);
                    }
                    else {
                        $("#txtIsActive").prop("checked", true);
                    }
                }
            });
        };
        //  ClosseAttendence Type//
    });


    function LoadGrid() {
        var dataTable;
        dataTable = $('#tblDataList').DataTable({
            "ajax": {
                "url": '@Url.Action("ShowInfo", "UserAccess")',
                "type": "GET",
                "datatype": "json"
            },
            "columns": [
            {
                "data": "ID", "render": function (data) {
                    return "<a class='btn' id='lnkID'>" + data + "</a>"
                }
                },
                { "data": "username", "autowidth": true },
                { "data": "EmployeeName", "autowidth": true },
                { "data": "Role", "autowidth": true },
                { "data": "AccessCode", "autowidth": true },
                { "data": "Status", "autowidth": true },
                { "data": "EntryDate", "autowidth": true },
            ],
            "lengthChange": false,
            "pageLength": 5,
            "order": [[0, "Desc"]],
            "sScrollY": "100%",
            "scrollX": true,
            "sScrollX": "100%",
            "bDestroy": true

        });
    }




</script>




