
@{
    ViewBag.Title = "View_AllAttenReport";
    Layout = "~/Views/Shared/_MasterLayout.cshtml";
}


<link rel="stylesheet" href="~/FrontEnd/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

<link rel="stylesheet" href="~/FrontEnd/plugins/fontawesome-free/css/all.min.css">
<!-- Ionicons -->
<link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
<!-- SweetAlert2 -->
<link rel="stylesheet" href="~/FrontEnd/plugins/sweetalert2-theme-bootstrap-4/bootstrap-4.min.css">
<!-- Toastr -->
<link rel="stylesheet" href="~/FrontEnd/plugins/toastr/toastr.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="~/FrontEnd/dist/css/adminlte.min.css">
<link href="~/FrontEnd/plugins/datatables-responsive/css/responsive.bootstrap4.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css" rel="stylesheet" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
<link rel="stylesheet" href="/bower_components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<!-- Estiak -->

<style>
    .select2 {
        width: 100% !important;
    }

    input[type=text] {
        width: 100% !important;
    }

    textarea {
        width: 100% !important;
    }

    .dataTables_filter {
        margin-left: -80px !important;
    }

    .RedText {
        color: red;
    }

    .child {
        margin-bottom: 10px;
    }

    .select2-container--default.select2-container--focus .select2-selection--multiple, .select2-container--default.select2-container--focus .select2-selection--single {
        border-color: #80bdff;
        height: 37px !important;
        width: 100% !important;
    }

    .select2-container--default .select2-selection--single {
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 4px;
        height: 37px !important;
        width: 100% !important;
    }
    .linkbutton1 {
        background: #033C73 linear-gradient( 180deg, #306eaa, #072139) repeat-x;
        color: white;
        border: 1px solid #000000;
    }
        .linkbutton1:hover {
            color: #fff;
            background: #02294e linear-gradient( 180deg, #284968, #02294e) repeat-x;
        }

    #btnSubmit, #btnSubmit2, #btnClear, #btnDelete, #btnPrint {
        box-shadow: 0 0.125rem 0.625rem rgba(0, 6, 3, 0.4), 0 0.0625rem 0.125rem rgba(255, 255, 255, 0.5);
        width: 100px;
    }

    .center-div {
        width: 300px;
        height: 300px;
        position: absolute;
        left: 50%;
        top: 50%;
        margin-left: -150px;
        margin-top: -150px;
    }

    .spinner {
        position: fixed;
        z-index: 999;
        height: 100%;
        width: 100%;
        top: 0;
        left: 0;
        background-color: Black;
        filter: alpha(opacity=60);
        opacity: 0.6;
        -moz-opacity: 0.8;
    }

    .loader {
        margin: auto;
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #15a0ec;
        border-bottom: 16px solid #15a0ec;
        width: 20px;
        height: 80px;
    }

    .inner-div {
        background-color: white;
        border-radius: 15px;
        margin: auto;
        padding: 2%;
        width: 150px;
    }   
</style>


<section class="content-header">
    <div class="container-fluid">

        <div class="callout callout-info" style="padding: 10px; height: 52px;background-color: aliceblue;">

            <div class="row mb-2" style="height: 19px;">
                <div class="col-sm-6">
                    <h5>Attendence Report</h5>
                </div>
                <div class="col-sm-6">
                    <ol class="breadcrumb float-sm-right">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Employee Attendence Report</li>
                    </ol>
                </div>
            </div>
        </div>
    </div><!-- /.container-fluid -->
</section>

<section class="content">
    <div class="container-fluid">
        <div id="divLoader" class="spinner" style="display:none">
            <div class="center-div">
                <div class="inner-div">
                    <div class="spinner-border d-flex justify-content-center text-primary loader"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card card-primary">
                    <div class="card-body">
                        <div style="padding-top: 10px;">
                            <div class="row">
                                <div class="col-lg-6">
                                </div>
                                <div class="col-lg-6">
                                    <span id="message"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-3">
                                    <label for="inputName">Department</label>
                                    @Html.DropDownList("ddlDepartment", (SelectList)ViewBag.Department, "--All Department--", new { @class = "selectpicker" })
                                </div>
                                <div class="col-lg-3">
                                    <label for="inputName">Employee</label>
                                    @Html.DropDownList("ddlEmployee", (SelectList)ViewBag.LoadEmployee, "--All Employee--", new { @class = "selectpicker" })
                                </div>

                                <div class="col-lg-3">
                                    <label for="inputName">Date From</label>
                                    <input type="text" id="txtFromDate" class="form-control" style="width:100%" />
                                </div>
                                <div class="col-lg-3">
                                    <label for="inputName">To</label>
                                    <input type="text" id="txtToDate" class="form-control" style="width:100%" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                </div>
                                <div class="col-md-6">
                                    <div class="btn-group text-center" style="text-align:center; margin-top:10px">
                                        <button class="linkbutton1 btn" type="button" id="btnPresent"
                                                aria-label="Left Align">
                                            Present Report
                                        </button>
                                        <button class="linkbutton1 btn" type="button" id="btnAbsence"
                                                aria-label="Left Align">
                                            Absence Report
                                        </button>
                                        <button class="linkbutton1 btn" type="button" id="btnLate"
                                                aria-label="Left Align">
                                            Late Report
                                        </button>
                                        <button class="linkbutton1 btn" type="button" id="btnAll"
                                                aria-label="Left Align">
                                            Combine Report
                                        </button>
                                        <button class="linkbutton1 btn" type="button" id="btnMovement"
                                                aria-label="Left Align">
                                            Movement Report
                                        </button>
                                        <button class="linkbutton1 btn" type="button" style="" id="btnPreview"
                                                aria-label="Left Align">
                                            Employee Job Card
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                </div>
                            </div>
                        </div>
                            <div class="row">
                                <div class="col-lg-5">
                                </div>
                                <div class="col-lg-2">
                                    <button class="btn btn-defult" type="button" style="width:100%" id="btnPresentPreview"
                                            aria-label="Left Align">
                                        <span class="fa fa-print fa-lg" aria-hidden="true"></span>&nbsp;Print
                                    </button>
                                </div>
                                <div class="col-lg-5">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card card-primary">
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                            </div>
                            <div class="col-md-6">
                                <div class="row" id="mainDiv">
                                    <div class="col-md-6">
                                        @Html.DropDownList("ddlReportTypes", (SelectList)ViewBag.LoadReportTypes, "--Report Name--", new { @class = "selectpicker", @disabled = "disabled" })
                                    </div>
                                    <div class="col-md-3">
                                        @Html.DropDownList("ddlReportTypeFormat", (SelectList)ViewBag.LoadReportFormat, "--Format--", new { @class = "form-control" })
                                    </div>
                                    <div class="col-md-2">
                                        <button id="btnDownload" type="button" class="btn btn-secondary">Download</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div style=" padding: 10px;" id="divReportViwer">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        @*<div id="btnGroupID" class="btn-group" role="group" aria-label="Basic example">
            <button type="button" onclick="window.location.href='@Url.Action("Report", new { id = "PDF"})';" class="btn btn-secondary">PDF</button>
            <button type="button" onclick="window.location.href='@Url.Action("Report", new { id = "Excel"})';" class="btn btn-secondary">Excel</button>
            <button type="button" onclick="window.location.href='@Url.Action("Report", new { id = "Word"})';" class="btn btn-secondary">Word</button>
        </div>*@
    @*</div>*@
</section>

<script src="~/FrontEnd/plugins/jquery/jquery.min.js"></script>
<script src="~/FrontEnd/plugins/umd/popper.min.js"></script>
<script src="~/FrontEnd/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="~/FrontEnd/plugins/datatables/jquery.dataTables.min.js"></script>
<link href="~/FrontEnd/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" />
<script src="~/FrontEnd/plugins/jquery-ui/jquery-ui.min.js"></script>
<script src="~/FrontEnd/plugins/select2/js/select2.min.js"></script>
<script src="~/FrontEnd/jquery.timepicker.min.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js" type="text/javascript"></script>
<!-- Bootstrap 4 -->
<script src="~/FrontEnd/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- SweetAlert2 -->
<script src="~/FrontEnd/plugins/sweetalert2/sweetalert2.min.js"></script>
<!-- Toastr -->
<script src="~/FrontEnd/plugins/toastr/toastr.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="~/FrontEnd/dist/js/demo.js"></script>

<script type="text/javascript">

    const Toast = Swal.mixin({
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 6000,
    });

    // Start Temp Opeation JQuery//

    $(document).ready(function () {

        $("#ddlReportTypeFormat").val("PDF");

        $("#btnPresentPreview").css("display", "none");


        $('#btnDownload').click(function (event) {
            event.preventDefault();
            if ($("#ddlReportTypes").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select Report First!',
                })
                return;
            }
            if ($("#ddlReportTypeFormat").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select Report Format!',
                })
                return;
            }

            var EmployeeID = $('#ddlEmployee').val();
            var FromDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();
            var DepartmentCode = $('#ddlDepartment').val();
            var reportType = $('#ddlReportTypes').val();
            var reportFormat = $('#ddlReportTypeFormat').val();

            var url = "@Url.Action("Report", "AllAttenRe")" + "?EmployeeID=" + EmployeeID + "&formats=" + reportFormat + "&DepartmentCode=" + DepartmentCode + "&ReportType=" + reportType + "&FromDate=" + FromDate + "&ToDate=" + ToDate;
            window.location.href = url;
         });



        $('#btnMovement').click(function (event) {
            $("#divLoader").show();
            event.preventDefault();
            $('#ddlReportTypes').val('5').change();

            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select From Date',
                })
                return;
            }
            if ($("#txtToDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz select To Date',
                })
                return;
            }

            var EmployeeID = $('#ddlEmployee').val();
            var FromDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();

            var html = "";
            $.ajax({
                type: "GET",
                url: '@Url.Action("ShowEmpMovementList", "AllAttenRe")',
                data: { EmployeeID: EmployeeID, FromDate: FromDate, ToDate: ToDate },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data != 0) {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr background-color: #e2e2dc;font-weight: 600;>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='3'>";
                        html += "Employee Movement List";
                        html += "</td>";
                        html += "</tr>";


                        var arr = [];
                        for (var k = 0; k < data.length; k++) {

                            if (arr.indexOf(data[k]["EmpName"]) == -1) {
                                arr.push(data[k]["EmpName"]);
                            }

                        }
                        for (var k = 0; k < arr.length; k++) {

                            var EmpName = arr[k];

                            html += "<tr>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='1'>";
                            html += "Employee";
                            html += "</td>";
                            html += "<td style='text-align:left;font-size:20px'font-family:Book Antiqua; colspan='2'>";
                            html += EmpName;
                            html += "</td>";
                            html += "</tr>";


                            html += "<tr>";
                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Sl";
                            html += "</td>";
                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Date";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Movement Time";
                            html += "</td>";

                            html += "</tr>";


                            for (var i = 0; i < data.length; i++) {
                                var Sl = data[i]["Sl"];
                                var MovementDate = data[i]["MovementDate"];
                                var MovementTime = data[i]["MovementTime"];
                                var EpEmpName = data[i]["EmpName"];


                                if (EpEmpName == EmpName) {
                                    html += "<tr>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += Sl;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += MovementDate;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += MovementTime;
                                    html += "</td>";

                                    html += "</tr>";

                                }
                            }
                        }
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);


                    }
                    else {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "No data to preview!";
                        html += "</td>";
                        html += "</tr>";
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);
                    }
                    $("#divLoader").hide();
                },

                error: function (response) {
                    var message = $("#message");
                    message.css("color", "red");
                    message.html("error");
                }
            });


            //if ($("#ddlEmployee").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Please Select Employee',
            //    })
            //    return;
            //}

            //if ($("#txtFromDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz Select From Date',
            //    })
            //    return;
            //}
            //if ($("#txtToDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz select To Date',
            //    })
            //    return;
            //}
            //var FromDate = $('#txtFromDate').val();
            //var ToDate = $('#txtToDate').val();
            //var EmployeeID = $('#ddlEmployee').val();
            //var url = '../ReportViewer/WbFromReportViwer.aspx?EMR=' + EmployeeID + '&FromDate=' + FromDate + '&ToDate=' + ToDate;
            //window.open(url);
        });



        $('#btnPresentPreview').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select  Date',
                })
                return;
            }
            var Date = $('#txtFromDate').val();
            var DepartmentCOde = $('#ddlDepartment').val();
            var url = '../ReportViewer/WbFromReportViwer.aspx?DAP=' + Date + '&Department=' + DepartmentCOde;
            window.open(url);
        });

        function EmpDatetimeStatistics(FromDate, ToDate, EmployeeID, EmoStatus) {

            var html = "";

           $.ajax({
                type: "GET",
                url: '@Url.Action("ShowEmpDateTimeStatisitic", "AllAttenRe")',
               data: { FromDate: FromDate, ToDate: ToDate, EmployeeID: EmployeeID, EmoStatus: EmoStatus },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data != 0) {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "Employee Job Card";
                        html += "</td>";
                        html += "</tr>";

                        var EmployeeID = data[0]["EmployeeID"];
                        var FirstName = data[0]["FirstName"];
                        var Department = data[0]["DepartmentName"];
                        var DesignationName = data[0]["DesignationName"];

                        html += "<tr style='border:none'>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='1'>";
                        html += "Employee Name :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += FirstName;
                        html += "</td>";



                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='2'>";
                        html += "Employee ID :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += EmployeeID;
                        html += "</td>";

                        html += "</tr>";

                        html += "<tr style='border-left:none;border-right:none'>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='1'>";
                        html += "Department :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += Department;
                        html += "</td>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='2'>";
                        html += "Designation :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += DesignationName;
                        html += "</td>";

                        html += "</tr>";


                        html += "<tr>";
                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Date";
                        html += "</td>";
                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Days Name";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Shift In Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "In Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Late";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Shift Out Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Out Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Working Hours";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Status";
                        html += "</td>";

                        html += "</tr>";


                        for (var i = 0; i < data.length; i++) {

                            var DateData = data[i]["DateData"];
                            var DaysName = data[i]["DaysName"];
                            var ShiftStartTime = data[i]["ShiftStartTime"];
                            var InTime = data[i]["InTime"];
                            var LateCount = data[i]["LateCount"];
                            var ShiftEndTime = data[i]["ShiftEndTime"];
                            var OutTime = data[i]["OutTime"];
                            var WorkingHour = data[i]["WorkingHour"];
                            var EmoStatus = data[i]["EmoStatus"];

                            html += "<tr>";
                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += DateData;
                            html += "</td>";
                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += DaysName;
                            html += "</td>";

                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += ShiftStartTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += InTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += LateCount;
                            html += "</td>";


                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += ShiftEndTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += OutTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += WorkingHour;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += EmoStatus;
                            html += "</td>";

                            html += "</tr>";
                        }
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);
                    }
                    else {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "No data to preview!";
                        html += "</td>";
                        html += "</tr>";
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);
                    }
                    $("#divLoader").hide();
                },

                error: function (response) {
                    var message = $("#message");
                    message.css("color", "red");
                    message.html("error");
                }
            });
        }

        $('#btnPresent').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            $('#ddlReportTypes').val('1').change();
            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select  Date',
                })
                return;
            }
            var AttendenceDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();

            var DepartmentCode = $('#ddlDepartment').val();
            var EmployeeID = $('#ddlEmployee').val();
            var html = "";
            var EmoStatus = "P";
            if (EmployeeID !="")
            {
                EmpDatetimeStatistics(AttendenceDate, ToDate, EmployeeID, EmoStatus)
            }
            else
            {

                $.ajax({
                    type: "GET",
                    url: '@Url.Action("ShowEmpPresentList", "AllAttenRe")',
                    data: { AttendenceDate: AttendenceDate, DepartmentCode: DepartmentCode },
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        if (data != 0) {
                            jQuery("#divReportViwer").html('');

                            html += "<table style='width:100%;;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                            html += "Employee Present List";
                            html += "</td>";
                            html += "</tr>";


                            var arr = [];
                            for (var k = 0; k < data.length; k++) {
                                if (arr.indexOf(data[k]["DepartmentName"]) == -1) {
                                    arr.push(data[k]["DepartmentName"]);
                                }
                            }
                            
                            for (var k = 0; k < arr.length; k++) {
                                
                                var Department = arr[k];

                                html += "<tr style='background-color: #fffff1;'>";
                                html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='1'>";
                                html += "Department";
                                html += "</td>";
                                html += "<td style='text-align:left;font-size:20px'font-family:Book Antiqua; colspan='8s'>";
                                html += Department;
                                html += "</td>";
                                html += "</tr>";


                                html += "<tr>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Sl";
                                html += "</td>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Employee ID";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                html += "Employee Name";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Designation";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "In Time";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Late";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Out Time";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Status";
                                html += "</td>";
                                html += "</tr>";
                                var count = 0;
                                for (var i = 0; i < data.length; i++) {                                   
                                    var EmployeeID = data[i]["EmployeeID"];
                                    var FirstName = data[i]["FirstName"];
                                    var DesignationName = data[i]["DesignationName"];
                                    var InTime = data[i]["InTime"];
                                    var LateCount = data[i]["LateCount"];
                                    var Outtime = data[i]["Outtime"];
                                    var EmpStatus = data[i]["EmpStatus"];
                                    var EpDepartment = data[i]["DepartmentName"];
                                    if (Department == EpDepartment) {
                                        count++;
                                        html += "<tr>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += count;
                                        html += "</td>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmployeeID;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                        html += FirstName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += DesignationName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += InTime;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += LateCount;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += Outtime;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmpStatus;
                                        html += "</td>";
                                        html += "</tr>";
                                    }
                                }
                            }
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);


                        }
                        else {
                            jQuery("#divReportViwer").html('');

                            html += "<table style='width:100%;;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                            html += "No data to preview!";
                            html += "</td>";
                            html += "</tr>";
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);
                        }
                        $("#divLoader").hide();
                    },

                    error: function (response) {
                        var message = $("#message");
                        message.css("color", "red");
                        message.html("error");
                    }
                });

            }


        });

        $('#btnAbsence').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            $('#ddlReportTypes').val('2').change();
            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select  Date',
                })
                return;
            }
            var AttendenceDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();

            var DepartmentCode = $('#ddlDepartment').val();
            var EmployeeID = $('#ddlEmployee').val();
            var html = "";
            var EmoStatus = "A";
            if (EmployeeID != "") {
                EmpDatetimeStatistics(AttendenceDate, ToDate, EmployeeID, EmoStatus)
            }
            else {
                $.ajax({
                    type: "GET",
                    url: '@Url.Action("ShowEmpAbsentdList", "AllAttenRe")',
                    data: { AttendenceDate: AttendenceDate, DepartmentCode: DepartmentCode },
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        var fd = "";
                        if (data != 0) {
                            jQuery("#divReportViwer").html('');
                            @*html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '0'>";
                            html += "<tr style='border:none'>";
                            html += "<td style='text-align:right;padding: 6px;font-size:20px'font-family:Book Antiqua; colspan='6'>";
                            html += "<a href='@Url.Action("Report",  new { id = "PDF"})' style='background-color: #a99929;color: white;border-radius: 5px;font-size: large;padding: 3px;margin-right:2px'>PDF</a><a href='@Url.Action("Report", new { id = "Excel" })' style='background-color: #a99929;color: white;border-radius: 5px;font-size: large;padding: 3px;margin-right:2px'>Excel</a><a href='@Url.Action("Report", new { id = "Word" })' style='background-color: #a99929;color: white;border-radius: 5px;font-size: large;padding: 3px;margin-right:2px'>Word</a>";
                            html += "</td>";
                            html += "</tr>";
                            html += "</table>";*@

                            html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='6'>";
                            html += "Employee Absence List";
                            html += "</td>";
                            html += "</tr>";


                            var arr = [];
                            for (var k = 0; k < data.length; k++) {
                                if (arr.indexOf(data[k]["DepartmentName"]) == -1) {
                                    arr.push(data[k]["DepartmentName"]);
                                }

                            }
                            for (var k = 0; k < arr.length; k++) {

                                var Department = arr[k];

                                html += "<tr style='background-color: #fffff1;'>";
                                html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='1'>";
                                html += "Department";
                                html += "</td>";
                                html += "<td style='text-align:left;font-size:20px'font-family:Book Antiqua; colspan='5'>";
                                html += Department;
                                html += "</td>";
                                html += "</tr>";


                                html += "<tr>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Sl";
                                html += "</td>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Employee ID";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                html += "Employee Name";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Designation";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Status";
                                html += "</td>";
                                html += "</tr>";

                                var count = 0;
                                for (var i = 0; i < data.length; i++) {                                    
                                    var EmployeeID = data[i]["EmployeeID"];
                                    var FirstName = data[i]["FirstName"];
                                    var DesignationName = data[i]["DesignationName"];
                                    var EmpStatus = data[i]["EmpStatus"];
                                    var EpDepartment = data[i]["DepartmentName"];
                                    if (Department == EpDepartment) {
                                        count++;
                                        html += "<tr>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += count;
                                        html += "</td>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmployeeID;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                        html += FirstName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += DesignationName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmpStatus;
                                        html += "</td>";
                                        html += "</tr>";

                                    }
                                }
                            }
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);


                        }
                        else {
                            jQuery("#divReportViwer").html('');

                            html += "<table style='width:100%;;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                            html += "No data to preview!";
                            html += "</td>";
                            html += "</tr>";
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);
                        }
                        $("#divLoader").hide();
                    },

                    error: function (response) {
                        var message = $("#message");
                        message.css("color", "red");
                        message.html("error");
                    }
                });
            }

            //if ($("#txtFromDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz Select  Date',
            //    })
            //    return;
            //}
            //var Date = $('#txtFromDate').val();
            //var DepartmentCOde = $('#ddlDepartment').val();

            //var url = '../ReportViewer/WbFromReportViwer.aspx?DAA=' + Date + '&Department=' + DepartmentCOde;
            //window.open(url);



        });
        $('#btnLate').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            $('#ddlReportTypes').val('3').change();

            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select  Date',
                })
                return;
            }
            var AttendenceDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();

            var DepartmentCode = $('#ddlDepartment').val();
            var EmployeeID = $('#ddlEmployee').val();
            var html = "";
            var EmoStatus = "L";
            if (EmployeeID != "") {
                EmpDatetimeStatistics(AttendenceDate, ToDate, EmployeeID, EmoStatus)
            }
            else {

                $.ajax({
                    type: "GET",
                    url: '@Url.Action("ShowEmpLateList", "AllAttenRe")',
                    data: { AttendenceDate: AttendenceDate, DepartmentCode: DepartmentCode },
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function (data) {
                        if (data != 0) {
                            jQuery("#divReportViwer").html('');

                            html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                            html += "Employee Late List";
                            html += "</td>";
                            html += "</tr>";


                            var arr = [];
                            for (var k = 0; k < data.length; k++) {
                                if (arr.indexOf(data[k]["DepartmentName"]) == -1) {
                                    arr.push(data[k]["DepartmentName"]);
                                }

                            }
                            for (var k = 0; k < arr.length; k++) {

                                var Department = arr[k];

                                html += "<tr style='background-color: #fffff1;'>";
                                html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='1'>";
                                html += "Department";
                                html += "</td>";
                                html += "<td style='text-align:left;font-size:20px'font-family:Book Antiqua; colspan='8'>";
                                html += Department;
                                html += "</td>";
                                html += "</tr>";


                                html += "<tr>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Sl";
                                html += "</td>";
                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Employee ID";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                html += "Employee Name";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Designation";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "In Time";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Late";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Out Time";
                                html += "</td>";

                                html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                html += "Status";
                                html += "</td>";
                                html += "</tr>";

                                var count = 0;
                                for (var i = 0; i < data.length; i++) {
                                    count++;
                                    var EmployeeID = data[i]["EmployeeID"];
                                    var FirstName = data[i]["FirstName"];
                                    var DesignationName = data[i]["DesignationName"];

                                    var InTime = data[i]["InTime"];
                                    var LateCount = data[i]["LateCount"];
                                    var Outtime = data[i]["Outtime"];
                                    var EmpStatus = data[i]["EmpStatus"];
                                    var EpDepartment = data[i]["DepartmentName"];
                                    if (Department == EpDepartment) {
                                        html += "<tr>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += count;
                                        html += "</td>";
                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmployeeID;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                        html += FirstName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += DesignationName;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += InTime;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += LateCount;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += Outtime;
                                        html += "</td>";

                                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                        html += EmpStatus;
                                        html += "</td>";
                                        html += "</tr>";

                                    }
                                }
                            }
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);


                        }
                        else {
                            jQuery("#divReportViwer").html('');

                            html += "<table style='width:100%;;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                            html += "<tr>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                            html += "No data to preview!";
                            html += "</td>";
                            html += "</tr>";
                            html += "</table>";
                            html += "</div>";
                            $("#divReportViwer").append(html);
                        }
                        $("#divLoader").hide();
                    },

                    error: function (response) {
                        var message = $("#message");
                        message.css("color", "red");
                        message.html("error");
                    }
                });
            }

            //if ($("#txtFromDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz Select  Date',
            //    })
            //    return;
            //}
            //var Date = $('#txtFromDate').val();
            //var DepartmentCOde = $('#ddlDepartment').val();
            //var url = '../ReportViewer/WbFromReportViwer.aspx?DAL=' + Date + '&Department=' + DepartmentCOde;
            //window.open(url);
        });
        $('#btnAll').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            $('#ddlReportTypes').val('4').change();
            if ($("#txtFromDate").val() == "") {
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select  Date',
                })
                return;
            }
            var AttendenceDate = $('#txtFromDate').val();
            var DepartmentCode = $('#ddlDepartment').val();
            var html = "";
            $.ajax({
                type: "GET",
                url: '@Url.Action("ShowEmpAllList", "AllAttenRe")',
                data: { AttendenceDate: AttendenceDate, DepartmentCode: DepartmentCode },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data != 0) {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "Employee Attendence List";
                        html += "</td>";
                        html += "</tr>";


                        var arr = [];
                        for (var k = 0; k < data.length; k++) {
                            if (arr.indexOf(data[k]["DepartmentName"]) == -1) {
                                arr.push(data[k]["DepartmentName"]);
                            }

                        }
                        for (var k = 0; k < arr.length; k++) {

                            var Department = arr[k];

                            html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                            html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='1'>";
                            html += "Department";
                            html += "</td>";
                            html += "<td style='text-align:left;font-size:20px'font-family:Book Antiqua; colspan='8'>";
                            html += Department;
                            html += "</td>";
                            html += "</tr>";


                            html += "<tr style='background-color: #fbd8d6;'>";
                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Sl";
                            html += "</td>";
                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Employee ID";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                            html += "Employee Name";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Designation";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "In Time";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Late";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Out Time";
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += "Status";
                            html += "</td>";
                            html += "</tr>";

                            var count = 0;
                            for (var i = 0; i < data.length; i++) {
                                var EmployeeID = data[i]["EmployeeID"];
                                var FirstName = data[i]["FirstName"];
                                var DesignationName = data[i]["DesignationName"];

                                var InTime = data[i]["InTime"];
                                var LateCount = data[i]["LateCount"];
                                var Outtime = data[i]["Outtime"];
                                var EmpStatus = data[i]["EmpStatus"];
                                var EpDepartment = data[i]["DepartmentName"];
                                if (Department == EpDepartment) {
                                    count++;
                                    html += "<tr>";
                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += count;
                                    html += "</td>";
                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += EmployeeID;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='2'>";
                                    html += FirstName;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += DesignationName;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += InTime;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += LateCount;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += Outtime;
                                    html += "</td>";

                                    html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                                    html += EmpStatus;
                                    html += "</td>";
                                    html += "</tr>";

                                }
                            }
                        }
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);


                    }
                    else {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "No data to preview!";
                        html += "</td>";
                        html += "</tr>";
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);
                    }
                    $("#divLoader").hide();
                },

                error: function (response) {
                    var message = $("#message");
                    message.css("color", "red");
                    message.html("error");
                }
            });
            //if ($("#txtFromDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz Select  Date',
            //    })
            //    return;
            //}
            //var Date = $('#txtFromDate').val();
            //var DepartmentCOde = $('#ddlDepartment').val();
            //var url = '../ReportViewer/WbFromReportViwer.aspx?DALL=' + Date + '&Department=' + DepartmentCOde;
            //window.open(url);
        });

        $('#btnPreview').click(function (event) {
            event.preventDefault();
            $("#divLoader").show();
            $('#ddlReportTypes').val('6').change();
            if ($("#ddlEmployee").val() == "") {
                $("#divLoader").hide();
                Toast.fire({
                    icon: 'error',
                    title: 'Please Select Employee',
                })
                return;
            }

            if ($("#txtFromDate").val() == "") {
                $("#divLoader").hide();
                Toast.fire({
                    icon: 'error',
                    title: 'Plz Select From Date',
                })
                return;
            }
            if ($("#txtToDate").val() == "") {
                $("#divLoader").hide();
                Toast.fire({
                    icon: 'error',
                    title: 'Plz select To Date',
                })
                return;
            }
            var FromDate = $('#txtFromDate').val();
            var ToDate = $('#txtToDate').val();
            var EmployeeID = $('#ddlEmployee').val();


            var html = "";
            $.ajax({
                type: "GET",
                url: '@Url.Action("ShowEmpJobCard", "AllAttenRe")',
                data: { FromDate: FromDate, ToDate: ToDate, EmployeeID: EmployeeID },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    if (data != 0) {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr style='background-color: #e2e2dc;font-weight: 600;'>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "Employee Job Card";
                        html += "</td>";
                        html += "</tr>";

                        var EmployeeID = data[0]["EmployeeID"];
                        var FirstName = data[0]["FirstName"];
                        var Department = data[0]["DepartmentName"];
                        var DesignationName = data[0]["DesignationName"];

                        html += "<tr style='border:none'>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='1'>";
                        html += "Employee Name :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += FirstName;
                        html += "</td>";



                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='2'>";
                        html += "Employee ID :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += EmployeeID;
                        html += "</td>";

                        html += "</tr>";

                        html += "<tr style='border-left:none;border-right:none'>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='1'>";
                        html += "Department :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += Department;
                        html += "</td>";

                        html += "<td style='text-align:center;font-size:17px'font-family:Book Antiqua; colspan='2'>";
                        html += "Designation :";
                        html += "</td>";
                        html += "<td style='text-align:left;font-size:17px'font-family:Book Antiqua; colspan='3'>";
                        html += DesignationName;
                        html += "</td>";

                        html += "</tr>";


                        html += "<tr>";
                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Date";
                        html += "</td>";
                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Days Name";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Shift In Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "In Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Late";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Shift Out Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Out Time";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Working Hours";
                        html += "</td>";

                        html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                        html += "Status";
                        html += "</td>";

                        html += "</tr>";


                        for (var i = 0; i < data.length; i++) {

                            var DateData = data[i]["DateData"];
                            var DaysName = data[i]["DaysName"];
                            var ShiftStartTime = data[i]["ShiftStartTime"];
                            var InTime = data[i]["InTime"];
                            var LateCount = data[i]["LateCount"];
                            var ShiftEndTime = data[i]["ShiftEndTime"];
                            var OutTime = data[i]["OutTime"];
                            var WorkingHour = data[i]["WorkingHour"];
                            var EmoStatus = data[i]["EmoStatus"];

                            html += "<tr>";
                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += DateData;
                            html += "</td>";
                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += DaysName;
                            html += "</td>";

                            html += "<td style='text-align:center;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += ShiftStartTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += InTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += LateCount;
                            html += "</td>";


                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += ShiftEndTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += OutTime;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += WorkingHour;
                            html += "</td>";

                            html += "<td style='text-align:center;font-weight:bold;font-family:Book Antiqua; font-size:15px' colspan='1'>";
                            html += EmoStatus;
                            html += "</td>";

                            html += "</tr>";
                        }
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);


                    }
                    else {
                        jQuery("#divReportViwer").html('');

                        html += "<table style='width:100%;margin-left: 0px;margin-right: 0px;margin-top: 0px;margin-bottom: 0px;' border = '1'>";
                        html += "<tr>";
                        html += "<td style='text-align:center;font-size:20px'font-family:Book Antiqua; colspan='9'>";
                        html += "No data to preview!";
                        html += "</td>";
                        html += "</tr>";
                        html += "</table>";
                        html += "</div>";
                        $("#divReportViwer").append(html);
                    }
                    $("#divLoader").hide();
                },

                error: function (response) {
                    var message = $("#message");
                    message.css("color", "red");
                    message.html("error");
                }
            });
            //if ($("#ddlEmployee").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Please Select Employee',
            //    })
            //    return;
            //}

            //if ($("#txtFromDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz Select From Date',
            //    })
            //    return;
            //}
            //if ($("#txtToDate").val() == "") {
            //    Toast.fire({
            //        icon: 'error',
            //        title: 'Plz select To Date',
            //    })
            //    return;
            //}
            //var FromDate = $('#txtFromDate').val();
            //var ToDate = $('#txtToDate').val();
            //var EmployeeID = $('#ddlEmployee').val();
            //var url = '../ReportViewer/WbFromReportViwer.aspx?DARE=' + EmployeeID + '&FromDate=' + FromDate + '&ToDate=' + ToDate;
            //window.open(url);
        });

        $('.selectpicker').select2({
            language: {
                noResults: function () {
                    //return 'Not found <a class="add_new_item" href="javascript:void(0)">Add New</a>';
                }
            },
            escapeMarkup: function (markup) {
                return markup;
            }
        });

        $('#txtFromDate').datepicker({

            onSelect: function (date) {
                var FromDate = $('#txtFromDate').val();
                $('#txtToDate').val(FromDate);
                $("#txtToDate").datepicker('option', 'minDate', FromDate);
            },
            dateFormat: 'dd/mm/yy',
            changeMonth: true,
            changeYear: true,
            yearRange: '2010:2100',
            maxDate: '0'
        });

        $('#txtToDate').datepicker({
            dateFormat: 'dd/mm/yy',
            changeMonth: true,
            changeYear: true,
            yearRange: '2010:2100',
            maxDate: '0'
        });
        var d = new Date();
        var month = d.getMonth() + 1;
        var day = d.getDate();

        var output = (day < 10 ? '0' : '') + day + '/' +
            (month < 10 ? '0' : '') + month + '/' + d.getFullYear();
        $('#txtFromDate').val(output);
        $('#txtToDate').val(output);

        $("input:text,form").attr("autocomplete", "off");

    });
</script>

